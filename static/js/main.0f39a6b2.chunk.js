(this.webpackJsonpemphasoft=this.webpackJsonpemphasoft||[]).push([[0],{28:function(e,n,t){},29:function(e,n,t){"use strict";t.r(n);var s=t(1),o=t(0),r=t.n(o),i=t(9),a=t.n(i),c=t(8),u=t(4),p=(t(28),t(2)),l=t(3),h=t(6),b=t(5);function d(e){return Object(s.jsx)("button",{onClick:e.callback,className:"header__button",children:e.name})}var j=function(e){Object(h.a)(t,e);var n=Object(b.a)(t);function t(){return Object(p.a)(this,t),n.apply(this,arguments)}return Object(l.a)(t,[{key:"_quite",value:function(){this.props.onQuiteClick()}},{key:"_openPopup",value:function(){this.props.onOpenClick()}},{key:"render",value:function(){return Object(s.jsxs)("header",{className:"header",children:[Object(s.jsx)("img",{src:"images/logo.png",className:"header__logo",alt:"logo"}),this.props.isLoggedIn?Object(s.jsx)(d,{callback:this._quite.bind(this),name:"\u0412\u044b\u0439\u0442\u0438"}):Object(s.jsx)(d,{callback:this._openPopup.bind(this),name:"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]})}}]),t}(r.a.Component),O=Object(u.b)((function(e){return{isLoggedIn:e.isLoggedIn}}),(function(e){return{onOpenClick:function(){e({type:"OPEN_SIGNIN_POPUP"})},onQuiteClick:function(){e({type:"CLEAR_USERLIST"}),e({type:"QUITE"})}}}))(j),_=function(e){Object(h.a)(t,e);var n=Object(b.a)(t);function t(){return Object(p.a)(this,t),n.apply(this,arguments)}return Object(l.a)(t,[{key:"_closePopup",value:function(){this.props.onCloseClick()}},{key:"render",value:function(){return Object(s.jsx)("img",{src:"images/close.svg",alt:"X",className:"popup__close",onClick:this._closePopup.bind(this)})}}]),t}(r.a.Component),f=Object(u.b)((function(e){return{}}),(function(e){return{onCloseClick:function(){e({type:"CLOSE_POPUP"})}}}))(_),g=t(10),m=function(e){Object(h.a)(t,e);var n=Object(b.a)(t);function t(e){var s;return Object(p.a)(this,t),(s=n.call(this,e))._name=e.name,s._placeholder=e.placeholder,s._validation=s._validation.bind(Object(g.a)(s)),s}return Object(l.a)(t,[{key:"_validation",value:function(){0===this._input.value.length?(this._error.textContent="\u042d\u0442\u043e \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435","name"===this._name?this.props.onUsernameUnvalid():this.props.onPasswordUnvalid()):(this._error.textContent="","name"===this._name?this.props.onUsernameValid():this.props.onPasswordValid())}},{key:"render",value:function(){var e=this;return this.props.onUsernameUnvalid(),this.props.onPasswordUnvalid(),Object(s.jsxs)("div",{children:[Object(s.jsx)("input",{type:"name"===this._name?"text":"password",name:this._name,className:"popup__input",placeholder:this._placeholder,ref:function(n){e._input=n},onChange:this._validation}),Object(s.jsx)("span",{id:this._name,className:"popup__error",ref:function(n){e._error=n}})]})}}]),t}(r.a.Component),v=Object(u.b)((function(e){return{}}),(function(e){return{onUsernameValid:function(){e({type:"USERNAME_VALID"})},onUsernameUnvalid:function(){e({type:"USERNAME_UNVALID"})},onPasswordValid:function(){e({type:"PASSWORD_VALID"})},onPasswordUnvalid:function(){e({type:"PASSWORD_UNVALID"})}}}))(m),y=function(e){Object(h.a)(t,e);var n=Object(b.a)(t);function t(e){var s;return Object(p.a)(this,t),(s=n.call(this,e))._signInCallback=e.signInCallback,s}return Object(l.a)(t,[{key:"_signIn",value:function(e){var n=this;e.preventDefault();var t=document.querySelector("input[name=name]").value,s=document.querySelector("input[name=password]").value;this._signInCallback(t,s).then((function(e){e.non_field_errors?n._buttonError.textContent="\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c \u0438\u043b\u0438 \u0438\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f":e.token&&(localStorage.setItem("token",e.token),n.props.onEntering(),n.props.onLoggingIn())}))}},{key:"render",value:function(){var e=this;return Object(s.jsxs)("div",{className:"popup__content",children:[Object(s.jsx)(f,{}),Object(s.jsx)("h3",{className:"popup__title",children:"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"}),Object(s.jsxs)("form",{className:"popup__form",name:"new",children:[Object(s.jsx)(v,{name:"name",placeholder:"\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"}),Object(s.jsx)(v,{name:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c"}),Object(s.jsx)("span",{id:"enter",className:"popup__button-error",ref:function(n){e._buttonError=n}}),Object(s.jsx)("button",{name:"enter",className:this.props.isFormValid?"popup__button":"popup__button-disable",onClick:this._signIn.bind(this),disabled:!this.props.isFormValid,children:"\u0412\u043e\u0439\u0442\u0438"})]})]})}}]),t}(r.a.Component),P=Object(u.b)((function(e){return{isFormValid:e.popupValidation.isUsernameValid&&e.popupValidation.isPasswordValid}}),(function(e){return{onLoggingIn:function(){e({type:"OPEN_LOGGEDIN_POPUP"})},onEntering:function(){e({type:"ENTERED"})}}}))(y),k=function(e){Object(h.a)(t,e);var n=Object(b.a)(t);function t(){return Object(p.a)(this,t),n.apply(this,arguments)}return Object(l.a)(t,[{key:"_closePopup",value:function(){this.props.toClosePopup()}},{key:"render",value:function(){return Object(s.jsxs)("div",{className:"popup__content",children:[Object(s.jsx)(f,{}),Object(s.jsx)("h3",{className:"popup__title popup__title_succes",children:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d!"}),Object(s.jsx)("button",{type:"button",className:"popup__button",onClick:this._closePopup.bind(this),children:"\u041e\u043a"})]})}}]),t}(r.a.Component),I=Object(u.b)((function(e){return{}}),(function(e){return{toClosePopup:function(){e({type:"CLOSE_POPUP"})}}}))(k),U=function(e){Object(h.a)(t,e);var n=Object(b.a)(t);function t(){return Object(p.a)(this,t),n.apply(this,arguments)}return Object(l.a)(t,[{key:"_signIn",value:function(){this.props.onAuthButton()}},{key:"render",value:function(){return Object(s.jsxs)("div",{className:"popup__content",children:[Object(s.jsx)(f,{}),Object(s.jsx)("h3",{className:"popup__title",children:"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0438\u0440\u0443\u0439\u0442\u0435\u0441\u044c, \u0447\u0442\u043e\u0431\u044b \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439"}),Object(s.jsx)("button",{type:"button",className:"popup__button",onClick:this._signIn.bind(this),children:"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]})}}]),t}(r.a.Component),E=Object(u.b)((function(e){return{}}),(function(e){return{onAuthButton:function(){e({type:"OPEN_SIGNIN_POPUP"})}}}))(U),N=function(e){Object(h.a)(t,e);var n=Object(b.a)(t);function t(e){var s;return Object(p.a)(this,t),(s=n.call(this,e)).signInCallback=e.signInCallback,s}return Object(l.a)(t,[{key:"render",value:function(){return Object(s.jsx)("div",{className:"popup",children:this.props.isSignInPopupOpen?Object(s.jsx)(P,{signInCallback:this.signInCallback}):this.props.isLoggedInPopupOpen?Object(s.jsx)(I,{}):Object(s.jsx)(E,{})})}}]),t}(r.a.Component),S=Object(u.b)((function(e){return{isSignInPopupOpen:e.isPopupOpen.popupSignIn,isLoggedInPopupOpen:e.isPopupOpen.popupLoggedIn}}),(function(e){return{}}))(N),C=function(){function e(n){Object(p.a)(this,e),this._link=n.baseUrl}return Object(l.a)(e,[{key:"signIn",value:function(e,n){return fetch("".concat(this._link,"/api-token-auth/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:n})}).then((function(e){return e.ok?e.json():Promise.reject(e)})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430: "+e.status),e.json()}))}},{key:"getUsers",value:function(){return fetch("".concat(this._link,"/api/v1/users/"),{method:"GET",headers:{authorization:"Token ".concat(localStorage.getItem("token"))}}).then((function(e){return e.ok?e.json():Promise.reject(e)})).catch((function(e){return console.log("\u041e\u0448\u0438\u0431\u043a\u0430: "+e.status),e.json()}))}}]),e}(),x=function(e){Object(h.a)(t,e);var n=Object(b.a)(t);function t(e){var s;return Object(p.a)(this,t),(s=n.call(this,e))._getUsersCallback=e.getUsers,s}return Object(l.a)(t,[{key:"_getUsers",value:function(){var e=this;document.querySelector(".users__list").innerHTML="",this._getUsersCallback().then((function(e){return e.sort((function(e,n){return e.id>n.id?1:-1})),e})).then((function(n){n.forEach((function(n){e.props.onShowClick(n)}))}))}},{key:"_showError",value:function(){this.props.onErrorClick()}},{key:"render",value:function(){return Object(s.jsx)("button",{type:"button",className:"users__button",onClick:this.props.isLoggedIn?this._getUsers.bind(this):this._showError.bind(this),children:"\u0421\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439"})}}]),t}(r.a.Component),L=Object(u.b)((function(e){return{isLoggedIn:e.isLoggedIn}}),(function(e){return{onShowClick:function(n){var t={id:n.id,name:"".concat(n.first_name," ").concat(n.last_name),username:n.username};e({type:"ADD_USER",payload:t})},onErrorClick:function(){e({type:"OPEN_ERROR_POPUP"})}}}))(x),A=function(e){Object(h.a)(t,e);var n=Object(b.a)(t);function t(e){var s;return Object(p.a)(this,t),(s=n.call(this,e)).getUsers=e.getUsers,s}return Object(l.a)(t,[{key:"_findUser",value:function(){this.props.onFindUser(this._userInput.value)}},{key:"render",value:function(){var e=this;return Object(s.jsxs)("div",{className:"users",children:[Object(s.jsx)(L,{getUsers:function(){return e.getUsers()}}),this.props.usersAreShown?Object(s.jsxs)("div",{className:"users__search-field",children:[Object(s.jsx)("input",{className:"users__search",placeholder:"\u041f\u043e\u0438\u0441\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",ref:function(n){e._userInput=n}}),Object(s.jsx)("button",{className:"users__search-button",onClick:this._findUser.bind(this),children:"\u0418\u0441\u043a\u0430\u0442\u044c"})]}):null,Object(s.jsx)("ul",{className:"users__list",children:this.props.users.map((function(e){return Object(s.jsxs)("li",{className:"users__item",children:["id: ",e.id,Object(s.jsx)("br",{}),"Username: ",e.username,Object(s.jsx)("br",{}),"Name: ",e.name]},e.id)}))})]})}}]),t}(r.a.Component),w=Object(u.b)((function(e){return{users:e.users.usersList.filter((function(n){return n.username.includes(e.filterUsers)})),usersAreShown:e.users.usersAreShown}}),(function(e){return{onFindUser:function(n){e({type:"FIND_USER",payload:n})}}}))(A),V=function(e){Object(h.a)(t,e);var n=Object(b.a)(t);function t(){return Object(p.a)(this,t),n.apply(this,arguments)}return Object(l.a)(t,[{key:"_getApi",value:function(){return new C({baseUrl:"https://emphasoft-test-assignment.herokuapp.com"})}},{key:"_checkLogging",value:function(){null!=localStorage.getItem("token")&&this.props.toLogIn()}},{key:"render",value:function(){var e=this._getApi();return this._checkLogging(),Object(s.jsxs)("div",{className:"app",children:[Object(s.jsx)(O,{}),Object(s.jsx)(w,{getUsers:function(){return e.getUsers()}}),this.props.isPopupOpen?Object(s.jsx)(S,{signInCallback:function(n,t){return e.signIn(n,t)}}):null]})}}]),t}(r.a.Component),R=Object(u.b)((function(e){return{isPopupOpen:e.isPopupOpen.popupSignIn||e.isPopupOpen.popupLoggedIn||e.isPopupOpen.popupError}}),(function(e){return{toLogIn:function(){e({type:"ENTERED"})}}}))(V),D={popupSignIn:!1,popupLoggedIn:!1,popupError:!1};var T=t(16),G={usersList:[],usersAreShown:!1};var F=t(7),q={isUsernameValid:!1,isPasswordValid:!1};var M=Object(c.b)({isPopupOpen:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,n=arguments.length>1?arguments[1]:void 0;return"OPEN_SIGNIN_POPUP"===n.type?{popupSignIn:!0,popupLoggedIn:!1,popupError:!1}:"OPEN_LOGGEDIN_POPUP"===n.type?{popupSignIn:!1,popupLoggedIn:!0,popupError:!1}:"OPEN_ERROR_POPUP"===n.type?{popupSignIn:!1,popupLoggedIn:!1,popupError:!0}:"CLOSE_POPUP"===n.type?{popupSignIn:!1,popupLoggedIn:!1,popupError:!1}:e},isLoggedIn:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1?arguments[1]:void 0;return"ENTERED"===n.type||("QUITE"===n.type?(localStorage.removeItem("token"),!1):e)},users:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,n=arguments.length>1?arguments[1]:void 0;return"ADD_USER"===n.type?{usersList:[].concat(Object(T.a)(e.usersList),[n.payload]),usersAreShown:!0}:"CLEAR_USERLIST"===n.type?{usersList:[],usersAreShown:!1}:e},filterUsers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0;return"FIND_USER"===n.type?n.payload:e},popupValidation:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,n=arguments.length>1?arguments[1]:void 0;return"USERNAME_VALID"===n.type?Object(F.a)(Object(F.a)({},e),{},{isUsernameValid:!0}):"USERNAME_UNVALID"===n.type?Object(F.a)(Object(F.a)({},e),{},{isUsernameValid:!1}):"PASSWORD_VALID"===n.type?Object(F.a)(Object(F.a)({},e),{},{isPasswordValid:!0}):"PASSWORD_UNVALID"===n.type?Object(F.a)(Object(F.a)({},e),{},{isPasswordValid:!1}):e}}),Q=Object(c.c)(M);a.a.render(Object(s.jsx)(u.a,{store:Q,children:Object(s.jsx)(R,{})}),document.getElementById("root"))}},[[29,1,2]]]);
//# sourceMappingURL=main.0f39a6b2.chunk.js.map